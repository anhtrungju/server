execute as @e[type=marker,tag=nmr_celestial_watcher_spawn] at @s positioned ~ ~5 ~ if block ~ ~ ~ air if block ~ ~-1 ~ air if block ~ ~-2 ~ air if block ~ ~-3 ~ air if block ~ ~-4 ~ air if block ~ ~-5 ~ air if block ~ ~1 ~ air if block ~ ~2 ~ air if block ~ ~3 ~ air if block ~ ~4 ~ air if block ~ ~5 ~ air if block ~4 ~-5 ~-4 minecraft:end_portal_frame[eye=true] if block ~4 ~-5 ~4 minecraft:end_portal_frame[eye=true] if block ~-4 ~-5 ~-4 minecraft:end_portal_frame[eye=true] if block ~-4 ~-5 ~4 minecraft:end_portal_frame[eye=true] unless entity @e[type=vex,tag=nmr_celestial_watcher,distance=..50] unless score @s nmr.technical matches 1 unless score @s nmr.celestialwatcher.defeated matches 1 run function nmr:celestial_watcher/structure/start_spawning
execute as @a[advancements={nmr:progression/celestial_temple=false}] at @s if entity @e[type=marker,tag=nmr_celestial_watcher_spawn,distance=..12] run advancement grant @s only nmr:progression/celestial_temple